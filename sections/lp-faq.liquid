{{ 'lp-faq.css' | asset_url | stylesheet_tag }}

<section class="lp-faq" style="padding-top: {{ section.settings.padding_top_desktop }}px; padding-bottom: {{ section.settings.padding_bottom_desktop }}px;">
  <div class="section section--vertical-padding-none">
    <div class="lp-faq__container">
      <div class="lp-faq__header">
        {% if section.settings.heading != blank %}
          <h2 class="lp-faq__heading">{{ section.settings.heading }}</h2>
        {% endif %}
        
        {% if section.settings.text != blank %}
          <div class="lp-faq__text">{{ section.settings.text }}</div>
        {% endif %}
        
        {% if section.settings.button_text != blank %}
          <div class="lp-faq__button">
            <a href="{{ section.settings.button_url | default: '#' }}" 
               class="btn lp-faq__btn">
              {{ section.settings.button_text }}
            </a>
          </div>
        {% endif %}
      </div>
      
      {% if section.blocks.size > 0 %}
        <div class="lp-faq__items">
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'faq_item' %}
                <div class="lp-faq__item" {{ block.shopify_attributes }}>
                  <button class="lp-faq__question" type="button" aria-expanded="false">
                    <span class="lp-faq__question-text">{{ block.settings.question }}</span>
                    <span class="lp-faq__icon">
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="11" viewBox="0 0 18 11" fill="none">
                        <path d="M1.56342 1.43701L9.00005 8.87361L16.4366 1.43701" stroke="#333333" stroke-width="2.5" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </button>
                  
                  <div class="lp-faq__answer" aria-hidden="true">
                    <div class="lp-faq__answer-content">
                      {{ block.settings.answer }}
                    </div>
                  </div>
                </div>
            {% endcase %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>
</section>

<style>
  @media (max-width: 768px) {
    .lp-faq {
      padding-top: {{ section.settings.padding_top_mobile }}px !important;
      padding-bottom: {{ section.settings.padding_bottom_mobile }}px !important;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const section = document.querySelector('#shopify-section-{{ section.id }}');
    const faqItems = section.querySelectorAll('.lp-faq__item');
    
    faqItems.forEach(function(item) {
      const question = item.querySelector('.lp-faq__question');
      const answer = item.querySelector('.lp-faq__answer');
      
      question.addEventListener('click', function() {
        const isExpanded = question.getAttribute('aria-expanded') === 'true';
        
        // Close all other FAQ items
        faqItems.forEach(function(otherItem) {
          if (otherItem !== item) {
            const otherQuestion = otherItem.querySelector('.lp-faq__question');
            const otherAnswer = otherItem.querySelector('.lp-faq__answer');
            
            otherQuestion.setAttribute('aria-expanded', 'false');
            otherAnswer.setAttribute('aria-hidden', 'true');
            otherItem.classList.remove('lp-faq__item--active');
          }
        });
        
        // Toggle current item
        if (isExpanded) {
          question.setAttribute('aria-expanded', 'false');
          answer.setAttribute('aria-hidden', 'true');
          item.classList.remove('lp-faq__item--active');
        } else {
          question.setAttribute('aria-expanded', 'true');
          answer.setAttribute('aria-hidden', 'false');
          item.classList.add('lp-faq__item--active');
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "LP FAQ",
  "tag": "section",
  "class": "lp-faq-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Section Text",
      "default": "<p>Have questions? We've got answers. Find everything you need to know about our SPF drops below.</p>"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Contact Support"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "header",
      "content": "Desktop Padding"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top (Desktop)",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom (Desktop)",
      "default": 60
    },
    {
      "type": "header",
      "content": "Mobile Padding"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top (Mobile)",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom (Mobile)",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How do I use the SPF drops?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Shake well before use. Apply 2-3 drops to clean skin or mix with your moisturizer or makeup. Can be used alone or layered under makeup for all-day protection.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "LP FAQ",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "question": "How do I use the SPF drops?",
            "answer": "<p>Shake well before use. Apply 2-3 drops to clean skin or mix with your moisturizer or makeup. Can be used alone or layered under makeup for all-day protection.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "What SPF level do these drops provide?",
            "answer": "<p>Our SPF drops provide broad-spectrum SPF 46 protection against both UVA and UVB rays, offering superior daily protection for your skin.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Can I use these drops with makeup?",
            "answer": "<p>Absolutely! These drops work perfectly as a primer under makeup or can be mixed directly with your foundation for added protection and a natural glow.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Are the drops suitable for all skin types?",
            "answer": "<p>Yes, our SPF drops are formulated to work with all skin types, including sensitive skin. The lightweight, non-greasy formula won't clog pores or cause breakouts.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "How often should I reapply?",
            "answer": "<p>For optimal protection, reapply every 2 hours when exposed to direct sunlight, or after swimming, sweating, or toweling off.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}