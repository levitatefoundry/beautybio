{{ 'lp-video-list.css' | asset_url | stylesheet_tag }}

<section class="lp-video-list" style="padding-top: {{ section.settings.padding_top_desktop }}px; padding-bottom: {{ section.settings.padding_bottom_desktop }}px;">
  <div class="section section--vertical-padding-none">
    <div class="lp-video-list__container">
      <div class="lp-video-list__header">

        {% if section.settings.heading != blank %}
          <h2 class="lp-video-list__heading">{{ section.settings.heading }}</h2>
        {% endif %}
        
        {% if section.settings.description != blank %}
          <div class="lp-video-list__description">{{ section.settings.description }}</div>
        {% endif %}
      </div>
      
      {% if section.blocks.size > 0 %}
        <div class="lp-video-list__slider-container">
          <div class="swiper lp-video-list__swiper">
            <div class="swiper-wrapper lp-video-list__videos">
              {% for block in section.blocks %}
                {% case block.type %}
                  {% when 'video' %}
                    <div class="swiper-slide">
                      <div class="lp-video-list__video-item" {{ block.shopify_attributes }}>
                        {% if block.settings.video %}
                          <div class="lp-video-list__video-wrapper">
                            <div class="lp-video-list__video-container">
                              {{ block.settings.video | video_tag: 
                                autoplay: false, 
                                loop: false, 
                                controls: false,
                                muted: true,
                                image_size: '800x600'
                              }}
                              <div class="lp-video-list__play-button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="72" height="73" viewBox="0 0 72 73" fill="none">
                                    <rect x="0.5" y="0.655518" width="71" height="71" rx="35.5" stroke="white"/>
                                    <path d="M46 35.9808L27.25 46.8062L27.25 25.1555L46 35.9808Z" fill="white"/>
                                </svg>
                              </div>
                            </div>
                          </div>
                        {% endif %}
                      </div>
                    </div>
                {% endcase %}
              {% endfor %}
            </div>
            
            <!-- Navigation -->
            <div class="swiper-button-prev lp-video-list__button-prev">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="26" viewBox="0 0 14 26" fill="none">
                <path d="M13 25.071L0.999999 13.071L13 1.07104" stroke="white"/>
              </svg>
            </div>
            <div class="swiper-button-next lp-video-list__button-next">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="26" viewBox="0 0 14 26" fill="none">
                <path d="M0.999954 25L13 13L0.999953 1" stroke="white"/>
              </svg>
            </div>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</section>

{% style %}
  @media (max-width: 768px) {
    #shopify-section-{{ section.id }}.lp-video-list {
      padding-top: {{ section.settings.padding_top_mobile }}px !important;
      padding-bottom: {{ section.settings.padding_bottom_mobile }}px !important;
    }
  }
{% endstyle %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const section = document.querySelector('#shopify-section-{{ section.id }}');
    const swiperElement = section.querySelector('.lp-video-list__swiper');
    
    // Initialize Swiper
    if (swiperElement && typeof Swiper !== 'undefined') {
      const mobileSlides = {{ section.settings.slides_per_view_mobile | default: 1.3 }};
      const tabletSlides = {{ section.settings.slides_per_view_tablet | default: 2 }};
      const desktopSlides = {{ section.settings.slides_per_view_desktop | default: 3 }};
      
      const swiper = new Swiper(swiperElement, {
        slidesPerView: mobileSlides,
        spaceBetween: 20,
        centeredSlides: true,
        loop: true,
        autoHeight: false,
        pagination: {
          el: section.querySelector('.lp-video-list__pagination'),
          clickable: true
        },
        navigation: {
          nextEl: section.querySelector('.lp-video-list__button-next'),
          prevEl: section.querySelector('.lp-video-list__button-prev')
        },
        breakpoints: {
          768: {
            slidesPerView: tabletSlides,
            centeredSlides: false,
            loop: false,
          },
          1024: {
            slidesPerView: desktopSlides,
            centeredSlides: false,
            loop: false,
          }
        }
      });

      swiper.slides.forEach(ele => {
        ele.querySelector('.lp-video-list__play-button').addEventListener('click', function () {
            if (ele.querySelector('video').paused) {
                ele.querySelector('video')?.play();
            } else {
                ele.querySelector('video')?.pause();
            }
        })
      });

    }
  });
</script>

{% schema %}
{
  "name": "LP Video List",
  "tag": "section",
  "class": "lp-video-list-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Loved by Real Glow-Getters"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "header",
      "content": "Slider Settings"
    },
    {
      "type": "range",
      "id": "slides_per_view_mobile",
      "min": 1,
      "max": 3,
      "step": 0.1,
      "label": "Slides Per View (Mobile)",
      "default": 1.3
    },
    {
      "type": "range",
      "id": "slides_per_view_tablet",
      "min": 1,
      "max": 4,
      "step": 0.5,
      "label": "Slides Per View (Tablet)",
      "default": 2
    },
    {
      "type": "range",
      "id": "slides_per_view_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "label": "Slides Per View (Desktop)",
      "default": 3
    },
    {
      "type": "header",
      "content": "Desktop Padding"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top (Desktop)",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom (Desktop)",
      "default": 60
    },
    {
      "type": "header",
      "content": "Mobile Padding"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top (Mobile)",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom (Mobile)",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "video",
          "id": "video",
          "label": "Video"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "LP Video List",
      "blocks": [
        {
          "type": "video"
        },
        {
          "type": "video"
        },
        {
          "type": "video"
        }
      ]
    }
  ]
}
{% endschema %}